---
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: AIServiceBackend
metadata:
  name: openai
  namespace: network
spec:
  schema:
    name: OpenAI
  backendRef:
    name: openai-backend
    kind: Backend
    group: gateway.envoyproxy.io
---
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: AIServiceBackend
metadata:
  name: anthropic
  namespace: network
spec:
  schema:
    name: Anthropic
  backendRef:
    name: anthropic-backend
    kind: Backend
    group: gateway.envoyproxy.io
---
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: AIServiceBackend
metadata:
  name: google
  namespace: network
spec:
  schema:
    name: GoogleGemini
  backendRef:
    name: google-backend
    kind: Backend
    group: gateway.envoyproxy.io
---
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: AIServiceBackend
metadata:
  name: vercel
  namespace: network
spec:
  schema:
    name: OpenAI
  backendRef:
    name: vercel-backend
    kind: Backend
    group: gateway.envoyproxy.io
---
# Security Policies for Outbound Authentication
apiVersion: gateway.envoyproxy.io/v1alpha1
kind: BackendSecurityPolicy
metadata:
  name: openai-auth
  namespace: network
spec:
  targetRef:
    group: aigateway.envoyproxy.io
    kind: AIServiceBackend
    name: openai
  # Assuming standard Envoy Gateway syntax for API Key injection
  # Note: Syntax might vary based on EG version
  authentication:
    apiKey:
      type: Header
      name: Authorization
      valuePrefix: "Bearer "
      secretRef:
        name: openai-secret
        key: api-key
---
apiVersion: gateway.envoyproxy.io/v1alpha1
kind: BackendSecurityPolicy
metadata:
  name: anthropic-auth
  namespace: network
spec:
  targetRef:
    group: aigateway.envoyproxy.io
    kind: AIServiceBackend
    name: anthropic
  authentication:
    apiKey:
      type: Header
      name: x-api-key
      secretRef:
        name: anthropic-secret
        key: api-key
---
apiVersion: gateway.envoyproxy.io/v1alpha1
kind: BackendSecurityPolicy
metadata:
  name: google-auth
  namespace: network
spec:
  targetRef:
    group: aigateway.envoyproxy.io
    kind: AIServiceBackend
    name: google
  authentication:
    apiKey:
      type: Query
      name: key
      secretRef:
        name: google-secret
        key: api-key
---
apiVersion: gateway.envoyproxy.io/v1alpha1
kind: BackendSecurityPolicy
metadata:
  name: vercel-auth
  namespace: network
spec:
  targetRef:
    group: aigateway.envoyproxy.io
    kind: AIServiceBackend
    name: vercel
  authentication:
    apiKey:
      type: Header
      name: Authorization
      valuePrefix: "Bearer "
      secretRef:
        name: vercel-secret
        key: api-key

---
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: AIGatewayRoute
metadata:
  name: llm-router
spec:
  parentRefs:
    - name: envoy-ai
      namespace: network
      kind: Gateway
      group: gateway.networking.k8s.io
  rules:
    # Google Flash 2.5 (Mapped to gemini-1.5-flash for demo)
    - matches:
        - headers:
            - name: x-ai-eg-model
              value: "google/gemini-3-flash-preview"
      backendRefs:
        - name: google
          # modelNameOverride: "gemini-1.5-flash" # Uncomment when supported/verified

    # Google Gemini 2.5 Pro (Mapped to gemini-1.5-pro for demo)
    - matches:
        - headers:
            - name: x-ai-eg-model
              value: "google/gemini2.5pro"
      backendRefs:
        - name: google
          # modelNameOverride: "gemini-1.5-pro"

    # Google Models Wildcard
    - matches:
        - headers:
            - name: x-ai-eg-model
              type: RegularExpression
              value: "google/.*"
      backendRefs:
        - name: google
    # Vercel Models
    - matches:
        - headers:
            - name: x-ai-eg-model
              type: RegularExpression
              value: "vercel/.*"
      backendRefs:
        - name: vercel
    # Anthropic Models
    - matches:
        - headers:
            - name: x-ai-eg-model
              type: RegularExpression
              value: "anthropic/.*"
      backendRefs:
        - name: anthropic
    # Default to OpenAI
    - matches:
        - headers:
            - name: x-ai-eg-model
              type: RegularExpression
              value: "openai/.*"
      backendRefs:
        - name: openai
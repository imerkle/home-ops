---
# Unified MCPRoute aggregating multiple MCP servers
# Tools will be prefixed: flux-mcp-backend__*, github-mcp__*
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: MCPRoute
metadata:
  name: mcp-unified
  annotations:
    external-dns.alpha.kubernetes.io/hostname: mcp.${DOMAIN1}
spec:
  # hostnames:
  #   - mcp.${DOMAIN1}
  parentRefs:
    - name: envoy-ai
      namespace: network
      kind: Gateway
      group: gateway.networking.k8s.io
  path: "/mcp"
  backendRefs:
    # Flux MCP - Kubernetes/Flux management tools
    - name: flux-mcp-backend
      kind: Backend
      group: gateway.envoyproxy.io
      path: "/mcp"
    # GitHub MCP - GitHub tools (issues, PRs, code)
    # - name: github-mcp
    #   kind: Backend
    #   group: gateway.envoyproxy.io
    #   path: "/mcp/x/issues/readonly"
    #   securityPolicy:
    #     apiKey:
    #       secretRef:
    #         name: github-mcp-token

